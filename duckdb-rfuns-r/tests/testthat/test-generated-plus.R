# Generated by helper-gen.R: do not edit by hand
test_that('<dbl> + <dbl>', {
  con <- local_con()
  #  1 + 1 
  in_df <- tibble::tibble(x1 = 1, x2 = 1)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  1e+06 + 2e+06 
  in_df <- tibble::tibble(x1 = 1e+06, x2 = 2e+06)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  1e+09 + 2e+09 
  in_df <- tibble::tibble(x1 = 1e+09, x2 = 2e+09)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  1 + NA_real_ 
  in_df <- tibble::tibble(x1 = 1, x2 = NA_real_)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  NA_real_ + 2 
  in_df <- tibble::tibble(x1 = NA_real_, x2 = 2)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


})

test_that('<int> + <int>', {
  con <- local_con()
  #  1 + 2 
  in_df <- tibble::tibble(x1 = 1, x2 = 2)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  NaN + 2 
  in_df <- tibble::tibble(x1 = NaN, x2 = 2)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  NA_real_ + 2 
  in_df <- tibble::tibble(x1 = NA_real_, x2 = 2)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  1 + NA_real_ 
  in_df <- tibble::tibble(x1 = 1, x2 = NA_real_)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


  #  1 + NaN 
  in_df <- tibble::tibble(x1 = 1, x2 = NaN)
  in_rel <- duckdb:::rel_from_df(con, in_df)
  out_rel <- duckdb:::rel_project(in_rel,
      list(duckdb:::expr_function(
        'r_base::+', 
        list(
          duckdb:::expr_reference('x1'),
          duckdb:::expr_reference('x2')
        )
      ))
  )
  out_df <- duckdb:::rel_to_altrep(out_rel)
  expect_snapshot(out_df)


})

